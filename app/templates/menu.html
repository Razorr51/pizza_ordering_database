{% extends "base.html" %}

{% block head_styles %}
  <style>
    .wrap { max-width:1100px; margin:32px auto; padding:0 16px; }
    h1 { font-size:32px; margin:0 0 8px; }
    .sub { color:var(--muted); margin-bottom:24px; }
    .section { margin-top:28px; }
    .category { font-size:20px; margin: 12px 0 10px; }
    .grid { display:grid; grid-template-columns: repeat(auto-fill, minmax(240px,1fr)); gap:16px; }
    .card { background: radial-gradient(1200px 300px at 0% 0%, rgba(77,88,121,0.18), transparent), var(--card);
            border: 1px solid rgba(100,116,139,0.2); border-radius:16px; padding:16px; box-shadow: 0 10px 25px rgba(0,0,0,0.25);}
    .title { font-weight:600; font-size:18px; margin:0 0 4px; }
    .muted { color:var(--muted); font-size:13px; min-height: 32px; }
    .price { margin-top:12px; font-weight:700; font-size:18px; }
    .pills { display:flex; gap:8px; flex-wrap:wrap; margin-top:10px; }
    .pill { font-size:12px; padding:4px 10px; border-radius:999px; background:#21304d; border:1px solid rgba(100,116,139,0.35);}
    .pill.veg  { border-color: rgba(110,231,183,0.8); color: var(--accent); }
    .pill.vege { border-color: rgba(251,191,36,0.8); color: var(--warning); }
    .searchbar { margin: 12px 0 24px; }
    .searchbar input { width:100%; padding:12px 14px; border-radius:10px; border:1px solid rgba(100,116,139,0.35); background:#0f1629; color:var(--text); outline:none; }
    .extras-block { margin-top:12px; }
    .extras-heading { font-size:18px; margin:16px 0 10px; }
  </style>
{% endblock %}

{% block content %}
  <div class="wrap">
    <h1>üçï Alibrandi's Menu</h1>
    <div class="sub">Use the search to filter.</div>

    <div class="searchbar">
      <input placeholder="Search pizzas, drinks, desserts, or ingredients‚Ä¶" oninput="onSearch(this)" />
    </div>

    <div class="section">
      <div class="category">Pizzas</div>
      <div class="grid">
        {% for p in pizzas %}
          <div class="card" data-item data-name="{{ p.pizza_name }}" data-ing="{{ p.ingredients or '' }}">
            <div class="title">{{ p.pizza_name }}</div>
            <div class="muted">{{ p.ingredients or '‚Äî' }}</div>
            <div class="pills">
              {% if p.is_vegan %}<span class="pill veg">vegan</span>{% endif %}
              {% if p.is_vegetarian and not p.is_vegan %}<span class="pill vege">vegetarian</span>{% endif %}
            </div>
            <div class="price">‚Ç¨ {{ '%.2f'|format(p.final_price|float) }}</div>
          </div>
        {% endfor %}
      </div>
    </div>

    {% if drinks %}
      <div class="section">
        <div class="category">Drinks</div>
        <div class="grid">
          {% for d in drinks %}
            <div class="card" data-item data-name="{{ d.name }}">
              <div class="title">{{ d.name }}</div>
              <div class="pills">
                {% if d.is_vegan %}<span class="pill veg">vegan</span>{% endif %}
                {% if d.is_vegetarian and not d.is_vegan %}<span class="pill vege">vegetarian</span>{% endif %}
              </div>
              <div class="price">‚Ç¨ {{ '%.2f'|format(d.final_price|float) }}</div>
            </div>
          {% endfor %}
        </div>
      </div>
    {% endif %}

    {% if desserts %}
      <div class="section">
        <div class="category">Desserts</div>
        <div class="grid">
          {% for d in desserts %}
            <div class="card" data-item data-name="{{ d.name }}">
              <div class="title">{{ d.name }}</div>
              <div class="pills">
                {% if d.is_vegan %}<span class="pill veg">vegan</span>{% endif %}
                {% if d.is_vegetarian and not d.is_vegan %}<span class="pill vege">vegetarian</span>{% endif %}
              </div>
              <div class="price">‚Ç¨ {{ '%.2f'|format(d.final_price|float) }}</div>
            </div>
          {% endfor %}
        </div>
      </div>
    {% endif %}

    {% if other_extras %}
      <div class="section extras-block">
        {% for label, items in other_extras.items() %}
          <div class="extras-heading">{{ label.title() }}</div>
          <div class="grid">
            {% for item in items %}
              <div class="card" data-item data-name="{{ item.name }}">
                <div class="title">{{ item.name }}</div>
                <div class="pills">
                  {% if item.is_vegan %}<span class="pill veg">vegan</span>{% endif %}
                  {% if item.is_vegetarian and not item.is_vegan %}<span class="pill vege">vegetarian</span>{% endif %}
                </div>
                <div class="price">‚Ç¨ {{ '%.2f'|format(item.final_price|float) }}</div>
              </div>
            {% endfor %}
          </div>
        {% endfor %}
      </div>
    {% endif %}
  </div>

  <script>
    function onSearch(input){
      const q = input.value.toLowerCase();
      document.querySelectorAll('[data-item]').forEach(card => {
        const text = (card.dataset.name + ' ' + (card.dataset.ing || '')).toLowerCase();
        card.style.display = text.includes(q) ? '' : 'none';
      });
    }
  </script>
{% endblock %}
